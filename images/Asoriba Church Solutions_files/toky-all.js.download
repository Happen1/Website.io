if (typeof TokyBusiness == "undefined") {
var TokyBusiness = {url:'https://app.toky.co', load: function(p){ this.params=p;}};

var Toky = {load:function(p){TokyBusiness.load(p);}};

(function() {
// Localize jQuery variable
var jQuery;

/******** Load jQuery if not present *********/
if (window.jQuery === undefined || window.jQuery.fn.jquery !== '2.1.1' || window.jQuery.browser==undefined) {
    var script_tag = document.createElement('script');
    script_tag.setAttribute("type","text/javascript");
    script_tag.setAttribute("src",
        "https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js");
    if (script_tag.readyState) {
      script_tag.onreadystatechange = function () { // For old versions of IE
          if (this.readyState == 'complete' || this.readyState == 'loaded') {
              scriptLoadHandler();
          }
      };
    } else { // Other browsers
      script_tag.onload = scriptLoadHandler;
    }

    (document.getElementsByTagName("head")[0] || document.documentElement).appendChild(script_tag);
} else {
    jQuery = window.jQuery;
    main();
}

/******** Called once jQuery has loaded ******/
function scriptLoadHandler() {
    jQuery = window.jQuery.noConflict(true);
	try { jQuery.browser = get_browser_info();
	} catch (e) { console.error(e); }	
    main(); 
}

/******** Our main function ********/

function main() { 
	
	if (!isBrowserCapable()) return;
	loadedBusiness();
}

/* busines loaded */
function loadedBusiness() {

	TokyBusiness.button  = jQuery('div#toky-business-call-button');
	TokyBusiness.iframe  = null; 
	TokyBusiness.iframeZize = {hide:[180,50], show:[320,530]}; 
	TokyBusiness.requestMic = {};	
	TokyBusiness.callInactive = true;	

	TokyBusiness.trackingInitialize();

	var username,option,color,text,position,radio,show_option,onecall,bubble,bubble_title,bubble_message,no_bubble,audio,lang,btn_ico,set_lang='',call_enable = 'true';
	
	var btn = TokyBusiness.button;
	
	if (btn.length==0) {
		
		jQuery('body').append('<div id="toky-business-call-button"></div>');
		TokyBusiness.button  = jQuery('div#toky-business-call-button');
		btn = TokyBusiness.button;
		
		try {
			if (TokyBusiness.params['option']=='true') {
				delete TokyBusiness.params['option'];
				TokyBusiness.params['show_option'] = 'true';	
			}
		} catch (e) {}
		
		for(var name in TokyBusiness.params) {

			if (name.match(/^(set_lang_)[a-z0-9_]+$/)) {
				set_lang+= '&'+name+'='+TokyBusiness.params[name]; 
			}

			if (name=='lang') lang = TokyBusiness.params[name];
			if (name=='username') username = TokyBusiness.params[name];
			if (name=='option') option = TokyBusiness.params[name];
			if (name=='color') color = TokyBusiness.params[name];
			if (name=='text') text = TokyBusiness.params[name];
			if (name=='position') position = TokyBusiness.params[name];
			if (name=='radio') radio = TokyBusiness.params[name];
			if (name=='show_option') show_option = TokyBusiness.params[name];
			if (name=='onecall') onecall = TokyBusiness.params[name];
			if (name=='bubble') bubble = TokyBusiness.params[name];
			if (name=='bubble_title') bubble_title = TokyBusiness.params[name];
			if (name=='bubble_message') bubble_message = TokyBusiness.params[name];
			if (name=='no_bubble') no_bubble = TokyBusiness.params[name];
			if (name=='audio') audio = TokyBusiness.params[name];
			if (name=='call_enable') call_enable = TokyBusiness.params[name];
			if (name=='btn_ico') btn_ico = TokyBusiness.params[name];
		}	
	} else {
				lang = '';
			set_lang = '';
			btn_ico  = btn.attr('toky-btn-ico');
			username = btn.attr('toky-username');
			  option = btn.attr('toky-option');
			   color = btn.attr('toky-btn-color');
			    text = btn.attr('toky-btn-text');
			position = btn.attr('toky-btn-position');
			   radio = btn.attr('toky-btn-radio');
		 show_option = btn.attr('toky-show-option');
			 onecall = btn.attr('toky-one-click-call');
			  bubble = btn.attr('toky-bubble');
		bubble_title = btn.attr('toky-bubble-title');
	  bubble_message = btn.attr('toky-bubble-message');
	  		no_bubble = btn.attr('toky-no-bubble');
			audio = btn.attr('toky-bubble-audio')!==undefined;	
	}
	
	btn.hide();

	if (jQuery.browser.name.indexOf("chrome") >= 0 && 
		!location.href.match(/^(https)/g) &&
		jQuery.browser.version>=47
	) call_enable = 'false';
		
	if (username===undefined && username=='') {
		console.error('undefined attribute toky-username');
		return;
	}							

	if (btn_ico==undefined) btn_ico = '';
	if (lang==undefined) lang = '';
	if (text==undefined) text = '';	 
	if (color==undefined) color = 'green';	 
	if (onecall==undefined) onecall = 'false';	 		 
	if (position==undefined) position = 'right';	 		 		
	if (option==undefined) option = '0';	 		 		
	if (radio==undefined) radio = '50';	 		 			
	if (show_option==undefined) show_option = 'false';	 		 				
	if (!option.match(/^[0-9]+$/)) option = '0';
	if (bubble_title==undefined) bubble_title = '';	 
	if (bubble_message==undefined) bubble_message = '';	 
	if (no_bubble==undefined) no_bubble = 'false';

	bubble = (bubble==undefined || bubble=='true') ? 'true' : 'false';	
	
	TokyBusiness.play_audio = audio;


	if (!no_bubble.match(/^(true|false)$/)) no_bubble = 'false';

	TokyBusiness.no_bubble = false;
	if (no_bubble=='true') {
		bubble_title = '';	
		bubble_message = '';	
		TokyBusiness.iframeZize.hide = TokyBusiness.iframeZize.show;
		TokyBusiness.no_bubble = true;

	}

	TokyBusiness.is_bubble = (bubble=='false') ? false : true;
		
	if (getCookie('toky-audio-play')=='') {
		if (audio) {			
			TokyBusiness.audio1 = document.createElement('audio');
			TokyBusiness.audio1.setAttribute('src', TokyBusiness.url+'/resources/audio/chime_bell_ding.wav');					
		}
	} 
	else {
		bubble = 'false';
		bubble_title = '';	 
		bubble_message = '';	 		
	}

	if (audio && bubble=='true') {
		TokyBusiness.audio2 = document.createElement('audio');
		TokyBusiness.audio2.setAttribute('src', TokyBusiness.url+'/resources/audio/music_marimba_chord.wav');
	}

		
	var mul = 6.5,
		min = 100+text.length*mul 

	if (TokyBusiness.iframeZize.hide[0]<min)
		TokyBusiness.iframeZize.hide[0] = 100+text.length*mul;
	
	if (TokyBusiness.iframeZize.hide[0]>TokyBusiness.iframeZize.show[0]) 
		TokyBusiness.iframeZize.hide[0] = TokyBusiness.iframeZize.show[0];
	

	if (!color.match(/^(green|white|blue)$/)) {
		var colors = color.split(','),
			msg_error = 'invalid toky-btn-color; green|white|blue or hex background|hover|text-color';
			
		for (var i = 0; i < colors.length; i++) {
			if(!colors[i].match(/^(#)([0-9a-z]{3}|[0-9a-z]{6})$/gi)) {
				console.error(msg_error);
				return;							
			}
		}
		if (colors.length!=3) {
			console.error(msg_error);
			return;										
		}
		color = color.replace(/#/gi, '')
	}

	radio = radio*1;
	if (radio>50 && radio<0) {
		console.error('invalid toky-one-radio; 0-50 / radio: '+radio);
		radio = '50';
		// return;
	}

	if (!show_option.match(/^(true|false)$/)) {
		console.error('invalid toky-show-option; true|false / show_option: '+show_option);
		show_option = 'false';
		// return;
	}

	if (!onecall.match(/^(true|false)$/)) {
		console.error('invalid toky-one-click-call; true|false / onecall: '+onecall);
		onecall = 'false';
		// return;
	}

	if (!position.match(/^(right|left)$/)) {
		console.error('invalid toky-btn-position; right|left / position: '+position);
		position = 'left';
		// return;
	}

	var iframe    = 'border:none;position:fixed;z-index: 9999999999999;bottom:10px;'+position+': 10px;overflow: hidden;display:block;background: transparent !important;opacity:1!important;visibility: inherit !important;',
		overlay   = 'display:none;background: #000;position: fixed;top: 0px;bottom: 0px;left: 0px;right: 0px;background-size: cover;z-index: 998;opacity: 0.7;',
		back      = 'display:none;color: #fff;position: fixed;z-index: 999;opacity: 1;border: 2px solid #fff;padding: 5px 20px 5px 40px;border-radius: 6px;',
		titleh4	  = 'color: #fff;font-size: 14px;',
		chromeh4  = back+'top: 120px;left: 330px;background: url('+TokyBusiness.url+'/resources/images/back/arrow-up.png) no-repeat center left 10px;',
		firefoxh4 = back+'top: 180px;left: 260px;background: url('+TokyBusiness.url+'/resources/images/back/arrow-up.png) no-repeat center left 10px;';

	TokyBusiness.requestMicTemp = '<div id="toky-request-mic-overlay" class="overlay" style="'+overlay+'"></div>'+
								  '<div id="toky-request-mic-chrome" style="'+chromeh4+'" class="animated bounce"><h4 style="'+titleh4+'"><text_mic></h4></div>'+
								  '<div id="toky-request-mic-firefox" style="'+firefoxh4+'"><h4 style="'+titleh4+'"><text_mic></h4></div>';

	var token = getCookie('toky-token');		   
	if (token=="") token = 'none';
	jQuery('body').append(
		'<div id="toky-iframe-content" style="display:none;">'+
		'<iframe src="'+TokyBusiness.url+'/widgets/business/'+username+'/'+token+'?color='+color+'&one_call='+onecall+'&text='+text+'&position='+position+'&option_id='+option+'&radio='+radio+'&bubble='+bubble+'&bubble_title='+bubble_title+'&bubble_message='+bubble_message+'&show_option='+show_option+'&no_bubble='+no_bubble+'&call_enable='+call_enable+'&lang='+lang+set_lang+'&btn_ico='+btn_ico+'" title="widget" style="width:'+TokyBusiness.iframeZize.hide[0]+'px; height: '+TokyBusiness.iframeZize.hide[0]+'px;'+iframe+'" ></iframe>'+
		'</div>'
	);

	TokyBusiness.iframe = jQuery('#toky-iframe-content');	
}

window.addEventListener('message', function(event) {
	try {
		if (TokyBusiness.button==undefined) return;
		
		var username = TokyBusiness.params==undefined ? TokyBusiness.button.attr('toky-username') : TokyBusiness.params.username;
		var audio    = TokyBusiness.audio2!==undefined;		
		
		if (event.data.TokyUsername==undefined) return;
		if (username.toUpperCase()!=event.data.TokyUsername.toUpperCase()) return;

		var btn 	= TokyBusiness.button, 
			iframe  = TokyBusiness.iframe;
		
		if (event.data.redirect!==undefined) {
			var url = 'https://toky.co/'+event.data.redirect+'?callnow';
		    var win = window.open(url, '_blank');
		    win.focus();
			return;
		}
			
		if (event.data.startCall!==undefined) {
			TokyBusiness.getTracking();			
			TokyBusiness.iframe.find('iframe').get(0).contentWindow.postMessage({
				'startCall':true,
				'data' : getCookie('tokyTranking')
			}, TokyBusiness.url);
		}	

		if (event.data.callInactive!==undefined) {
			TokyBusiness.callInactive = event.data.callInactive;
		}
		
		if (event.data.hideCallView!==undefined) {					
			
			if (TokyBusiness.no_bubble) {
				if (event.data.hideCallView) TokyBusiness.hide();

				event.data.hideCallView = false;
				event.data.show_bubble  = undefined;
			}	
			var s = event.data.hideCallView ? TokyBusiness.iframeZize.hide : TokyBusiness.iframeZize.show;		
			var	h = (event.data.show_bubble==undefined) ? s[1] : s[1]-200;

			if (getCookie('toky-audio-play')=='' && !TokyBusiness.no_bubble) {
				if (audio) {
					setTimeout(function(){
						TokyBusiness.audio2.play();	
					},1300);									
				}
				createCookie('toky-audio-play', 'Y', 1/24); /* 1 hs. */ 		
			}
						
			iframe.find('iframe').width(s[0]);
			iframe.find('iframe').height(h);			
		}


		if (event.data.tokyReady!==undefined) {
			var size = TokyBusiness.iframeZize.hide;
			if (!TokyBusiness.no_bubble) iframe.show();
			iframe.find('iframe').width(size[0]);
			iframe.find('iframe').height(size[1]).fadeIn();		

			if (getCookie('toky-audio-play')=='' && TokyBusiness.play_audio) {
				TokyBusiness.audio1.play();	

				if (!TokyBusiness.is_bubble) 
					createCookie('toky-audio-play', 'Y', 1/24); /* 1 hs. */ 	
							
			}			
		}
	
		if (event.data.showMic!==undefined) {
			if (TokyBusiness.requestMic.overlay==undefined) {
				jQuery('body').prepend(TokyBusiness.requestMicTemp.replace(/<text_mic>/gi, event.data.text_mic));			
				TokyBusiness.requestMic = {
					overlay: jQuery('#toky-request-mic-overlay'),
					chrome: jQuery('#toky-request-mic-chrome'),
					firefox: jQuery('#toky-request-mic-firefox')
				};
			}
		
			if (event.data.showMic) {
				TokyBusiness.requestMic.overlay.show();
				if (event.data.browser=='chrome') TokyBusiness.requestMic.chrome.fadeIn();
				if (event.data.browser=='firefox') TokyBusiness.requestMic.firefox.fadeIn();
			} else {
				TokyBusiness.requestMic.overlay.hide();
				if (event.data.browser=='chrome') TokyBusiness.requestMic.chrome.fadeOut();
				if (event.data.browser=='firefox') TokyBusiness.requestMic.firefox.fadeOut();			
			}		
		}
	
	 
		if (event.data.token!==undefined) {
			createCookie('toky-token', event.data.token, 1/12);		
		}
				
	} catch (e) {
		console.error(e);
		return;
	}
});

/******** is browser capable ********/
function isBrowserCapable() {
	try { 


	    var isMacLike = navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i) ? true : false;
        var isIOS = navigator.platform.match(/(iPhone|iPod|iPad)/i) ? true : false;

        if (isIOS) 
        	throw 'browser not supported';

		var isMobile = navigator.platform.toLowerCase().match(/arm/i) ? true : false;

		if (!jQuery.browser.name.match(/^(opera|firefox|chrome)$/))
			throw 'your browser is not supported';

		if (jQuery.browser.name == 'chrome' && jQuery.browser.version < 31)
			throw 'chrome version not supported';

		if (jQuery.browser.name == 'firefox' && jQuery.browser.version < 30)
			throw 'firefox version not supported';

		if (jQuery.browser.name == 'opera' && jQuery.browser.version < 22)
			throw 'opera version not supported';

		return true;
	}
	catch(err) {
		console.error(err);
		return false;
	}
}

/******** cookie functions ********/
var createCookie = function(name, value, days) {
    var expires;
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toGMTString();
    }
    else {
        expires = "";
    }
    document.cookie = name + "=" + value + expires + "; path=/";
}

function getCookie(c_name) {
    if (document.cookie.length > 0) {
        c_start = document.cookie.indexOf(c_name + "=");
        if (c_start != -1) {
            c_start = c_start + c_name.length + 1;
            c_end = document.cookie.indexOf(";", c_start);
            if (c_end == -1) {
                c_end = document.cookie.length;
            }
            return unescape(document.cookie.substring(c_start, c_end));
        }
    }
    return "";
}

//
// taken from http://stackoverflow.com/questions/5916900/how-can-you-detect-the-version-of-a-browser
//
function get_browser_info(){
    var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || []; 
    if(/trident/i.test(M[1])){
        tem=/\brv[ :]+(\d+)/g.exec(ua) || []; 
        return {name:'ie',version:(tem[1]||'')*1};
        }   
    if(M[1]==='Chrome'){
        tem=ua.match(/\bOPR\/(\d+)/)
        if(tem!=null)   {return {name:'opera', version:tem[1]*1};}
        }   
    M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
    if((tem=ua.match(/version\/(\d+)/i))!=null) {M.splice(1,1,tem[1]);}
    return {
      name: M[0].toLowerCase(),
      version: M[1]*1
    };
}

/******** tracking functions ********/

TokyBusiness.trackingInitialize = function() {
	TokyBusiness.trackTime = 1/24;
	TokyBusiness.date = new Date();
	TokyBusiness.scrollPercentage = 0;
	TokyBusiness.title = jQuery('title').html();
	TokyBusiness.scrollAction = null;
	TokyBusiness.scrollPercentageNow = 0;

	/** Default **/
	TokyBusiness.tracking = [{
		'action' : 'open',
		'tag' : 'OPEN',
		'page'	: TokyBusiness.title,
		'desc' : TokyBusiness.title,
		'url' : location.href,
		'scroll' : TokyBusiness.scrollPercentage+'%',
		'date' : TokyBusiness.date.getTime(),
	}];
	
	var data = getCookie('tokyTranking');
	var newTracking = [];
	if (data) {
		try {
			newTracking = JSON.parse(TokyBase64.decode(data));
			for (var i = 0; i < TokyBusiness.tracking.length; i++) {
				newTracking.push(TokyBusiness.tracking[i]);
			}
		} catch (e) {
			console.error('Base64 track invalid');
			newTracking = TokyBusiness.tracking;
		}
	} else {
		newTracking = TokyBusiness.tracking;
	}

	createCookie('tokyTranking', TokyBusiness.trackingEncode(newTracking), TokyBusiness.trackTime);	
	TokyBusiness.tracking = [];

	/*****/


	jQuery('a,button,input[type="submit"],input[type="button"],[toky-click-tracking]').click(function(){
		var desc = this.getAttribute('toky-click-tracking');
		if (desc==null) desc = this.innerHTML.replace(/(<([^>]+)>)|[\n\t]+/ig,"");

		TokyBusiness.date = new Date();

		if (TokyBusiness.scrollAction!=null) {
			TokyBusiness.scrollAction.date = TokyBusiness.date.getTime();

			TokyBusiness.tracking.push(TokyBusiness.scrollAction);
			TokyBusiness.scrollAction = null;
		}

		TokyBusiness.tracking.push({
			'action' : 'click',
			'tag' : this.tagName,
			'page'	: TokyBusiness.title,
			'desc' : desc,
			'url' : (this.href==undefined) ? location.href : this.href,
			'scroll' : Math.round(TokyBusiness.scrollPercentageNow) + '%',
			'date' : TokyBusiness.date.getTime(),
		});

		TokyBusiness.scrollPercentage = 0;

		var data = getCookie('tokyTranking');
		var newTracking = [];
		if (data) {
			try {
				newTracking = JSON.parse(TokyBase64.decode(data));
				for (var i = 0; i < TokyBusiness.tracking.length; i++) {
					newTracking.push(TokyBusiness.tracking[i]);
				}
			} catch (e) {
				console.error('Base64 track invalid');
				newTracking = TokyBusiness.tracking;
			}
		} else {
			newTracking = TokyBusiness.tracking;
		}

		createCookie('tokyTranking', TokyBusiness.trackingEncode(newTracking), TokyBusiness.trackTime);

		TokyBusiness.tracking = [];
		TokyBusiness.scrollAction = null;

	});

	jQuery(document).scroll(function(){
		var s = document.body.scrollTop / (document.body.clientHeight - window.innerHeight) * 100;
		if (s>TokyBusiness.scrollPercentage) TokyBusiness.scrollPercentage = (s>100)?100:s;

		TokyBusiness.scrollPercentageNow = (s>100)?100:s;

		TokyBusiness.scrollAction = {
			'action' : 'scroll',
			'tag' : 'SCROLL',
			'page'	: TokyBusiness.title,
			'desc' : TokyBusiness.title,
			'url' : location.href,
			'scroll' : Math.round(TokyBusiness.scrollPercentage) + '%',
			'date' : 0,
			'time' : 0
		};
	});
} 

TokyBusiness.trackingEncode = function(track) {
	var max  = 10; data = [];
	for (var i = 0; i < track.length; i++) {
		if (i>=(track.length-max)) data.push(track[i]);
	}	
	return TokyBase64.encode(JSON.stringify(data));
}

TokyBusiness.getTracking = function() {
	
	var data = getCookie('tokyTranking'), newTracking = [];	

	if (TokyBusiness.tracking.length>0) {
		if (data) {			
			try {				
				newTracking = JSON.parse(TokyBase64.decode(data));		
				for (var i = 0; i < TokyBusiness.tracking.length; i++) {				
					newTracking.push(TokyBusiness.tracking[i]);
				}				
			} catch (e) {
				createCookie('tokyTranking', '', 0);
				console.error('Base64 track invalid');
				newTracking = TokyBusiness.tracking;
			}
		} else {
			newTracking = TokyBusiness.tracking;
		}		
		createCookie('tokyTranking', TokyBusiness.trackingEncode(newTracking), TokyBusiness.trackTime);
		newTracking = [];
		TokyBusiness.tracking = [];
	}	
	
	data = getCookie('tokyTranking');
	
	if (TokyBusiness.scrollAction!=null) {
		TokyBusiness.date = new Date();
		TokyBusiness.scrollAction.date = TokyBusiness.date.getTime();
		
		if (data) {
			try {
				newTracking = JSON.parse(TokyBase64.decode(data));			
				newTracking.push(TokyBusiness.scrollAction);
			} catch (e) {
				createCookie('tokyTranking', '', 0);
				console.error('Base64 track invalid');
				newTracking = TokyBusiness.scrollAction;
			}
		} else {
			newTracking = TokyBusiness.scrollAction;
		}
		
		createCookie('tokyTranking', TokyBusiness.trackingEncode(newTracking), TokyBusiness.trackTime);
		TokyBusiness.scrollPercentage = 0;
		TokyBusiness.scrollAction = null;
		TokyBusiness.getTracking();
		return;
	}
		
	if (!data) 	console.warn('tokyTranking is null');

}

TokyBusiness.show = function() {
	if (!TokyBusiness.no_bubble) return;
	try {
		TokyBusiness.iframe.fadeIn();
	} catch (e) {
		console.error(e);
	}	
}
TokyBusiness.hide = function() {
	if (!TokyBusiness.no_bubble || !TokyBusiness.callInactive) return;
	try {
		TokyBusiness.iframe.fadeOut();
	} catch (e) {
		console.error(e);
	}
}

})(); // We call our anonymous function immediately

/**
*
*  TokyBase64 encode / decode
*  http://www.webtoolkit.info/
*
**/
var TokyBase64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(r){var t,e,o,a,h,n,d,C="",c=0;for(r=TokyBase64._utf8_encode(r);c<r.length;)t=r.charCodeAt(c++),e=r.charCodeAt(c++),o=r.charCodeAt(c++),a=t>>2,h=(3&t)<<4|e>>4,n=(15&e)<<2|o>>6,d=63&o,isNaN(e)?n=d=64:isNaN(o)&&(d=64),C=C+this._keyStr.charAt(a)+this._keyStr.charAt(h)+this._keyStr.charAt(n)+this._keyStr.charAt(d);return C},decode:function(r){var t,e,o,a,h,n,d,C="",c=0;for(r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<r.length;)a=this._keyStr.indexOf(r.charAt(c++)),h=this._keyStr.indexOf(r.charAt(c++)),n=this._keyStr.indexOf(r.charAt(c++)),d=this._keyStr.indexOf(r.charAt(c++)),t=a<<2|h>>4,e=(15&h)<<4|n>>2,o=(3&n)<<6|d,C+=String.fromCharCode(t),64!=n&&(C+=String.fromCharCode(e)),64!=d&&(C+=String.fromCharCode(o));return C=TokyBase64._utf8_decode(C)},_utf8_encode:function(r){r=r.replace(/\r\n/g,"\n");for(var t="",e=0;e<r.length;e++){var o=r.charCodeAt(e);128>o?t+=String.fromCharCode(o):o>127&&2048>o?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},_utf8_decode:function(r){for(var t="",e=0,o=0,a=0;e<r.length;)o=r.charCodeAt(e),128>o?(t+=String.fromCharCode(o),e++):o>191&&224>o?(a=r.charCodeAt(e+1),t+=String.fromCharCode((31&o)<<6|63&a),e+=2):(a=r.charCodeAt(e+1),c3=r.charCodeAt(e+2),t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&c3),e+=3);return t}};
}
